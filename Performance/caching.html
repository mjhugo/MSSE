<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Performance</title>
	
	<meta name="description" content="Performance">
	<meta name="author" content="Mike Hugo">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="../deck.js/core/deck.core.css">
	<link rel="stylesheet" href="../deck.js/extensions/goto/deck.goto.css">
	<link rel="stylesheet" href="../deck.js/extensions/menu/deck.menu.css">
	<link rel="stylesheet" href="../deck.js/extensions/navigation/deck.navigation.css">
	<link rel="stylesheet" href="../deck.js/extensions/status/deck.status.css">
	<link rel="stylesheet" href="../deck.js/extensions/hash/deck.hash.css">
	
	<!-- Theme CSS files (menu swaps these out) -->
	<link rel="stylesheet" id="style-theme-link" href="../deck.js/themes/style/swiss.css">
	<link rel="stylesheet" id="style-theme-link" href="../deck.js.custom/themes/style/msse.css">
	<link rel="stylesheet" id="transition-theme-link" href="../deck.js/themes/transition/horizontal-slide.css">

	<link href="../deck.js.custom/syntaxhighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="../deck.js.custom/syntaxhighlighter/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />

	<script src="../deck.js/modernizr.custom.js"></script>
</head>

<body class="deck-container">
<div class="slide">
</div><div class="slide"><h1>?Caching</h1>
<ul>
  <li>Domain objects</li>
  <li>Queries</li>
  <li>Overriding default cache settings</li>
</ul>
</div><div class="slide"><h1>Hibernate Cache</h1>
<ul>
  <li>Hibernate provides a second level cache for domain objects</li>
  <li>Good for “read mostly” or “read only” type of objects</li>
  <li>Different Cache Providers:
  <ul>
    <li>EHCache (default in Grails)</li>
    <li>OSCache</li>
    <li>SwarmCache</li>
    <li>JBoss Cache</li>
  </ul></li>
</ul>
</div><div class="slide"><h1>?Cache Strategies</h1>
<ul>
  <li>Transactional
  <ul>
    <li>(JTA environment only)</li>
  </ul></li>
  <li>Read-write
  <ul>
    <li>read committed</li>
  </ul></li>
  <li>Nonstrict-read-write
  <ul>
    <li>occasional updates</li>
    <li>unlikely that two transactions update same item simultaneously</li>
  </ul></li>
  <li>Read-only</li>
</ul>
</div><div class="slide"><h1>?equals / hashCode</h1>
<ul>
  <li>Define equality using “business key” - NOT primary key of object (exclude collections)</li>
  <li>Needed for anything stored in a set or 2nd level cache</li>
  <li>Can use Intellij to generate
  <ul>
    <li>Code &gt; Generate... &gt; equals and hashCode</li>
  </ul></li>
  <li>Or implement a framework like :
  <ul>
    <li>http://burtbeckwith.com/blog/?p=53</li>
  </ul></li>
  <li>Or use Groovy @Equals and @HashCode annotations</li>
</ul>
</div><div class="slide"><h1>?Caching in Grails</h1>
<ul>
  <li><p>in DataSource.groovy hibernate { cache.use_second_level_cache=true cache.use_query_cache=true cache.provider_class='net.sf.ehcache.hibernate.EhCacheProvider' }</p></li>
  <li><p>In domain class static mapping = { cache true }</p></li>
</ul>
</div><div class="slide"><h1>?Query Caching</h1>
<ul>
  <li>Requires that the domain objects being returned have caching turned on</li>
  <li>Can be done for queries written with
  <ul>
    <li>Criteria</li>
    <li>Dynamic Finders</li>
    <li>where queries????? TODO</li>
  </ul></li>
  <li>Any save of a domain class will clear the query cache</li>
  <li>Not as useful as you might expect</li>
  <li>Do your own performance testing!</li>
</ul>
</div><div class="slide"><h1>?Criteria</h1><p>def customerByName(nameToFind) {  def c = Customer.createCriteria()  return c.list() { } } eq('name', nameToFind) cache (true)</p>
</div><div class="slide"><h1>?Dynamic Finder</h1><p>def customerByName(nameToFind) {  Customer.findAllByName(nameToFind, } [cache:true])</p>
</div><div class="slide"><h1>?Where Query</h1><p>TODO</p>
</div><div class="slide"><h1>Clearing Cache</h1>
<ul>
  <li>sessionFactory.evictQueries()</li>
  <li>sessionFactory.evict(DomainClass.class)</li>
</ul>
</div>

<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>

<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
	<datalist id="goto-datalist"></datalist>
	<input type="submit" value="Go">
</form>

<a href="." title="Permalink to this slide" class="deck-permalink">#</a>


<script src="../deck.js/jquery-1.7.min.js"></script>

<!-- Deck Core and extensions -->
<script src="../deck.js/core/deck.core.js"></script>
<script src="../deck.js/extensions/hash/deck.hash.js"></script>
<script src="../deck.js/extensions/menu/deck.menu.js"></script>
<script src="../deck.js/extensions/goto/deck.goto.js"></script>
<script src="../deck.js/extensions/status/deck.status.js"></script>
<script src="../deck.js/extensions/navigation/deck.navigation.js"></script>

<script src="../deck.js.custom/syntaxhighlighter/scripts/shCore.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushPlain.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushCss.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushGroovy.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushJava.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushSql.js" type="text/javascript"></script>
<script src="../deck.js.custom/syntaxhighlighter/scripts/shBrushXml.js" type="text/javascript"></script>

<script src="../deck.js.custom/init.js" type="text/javascript"></script>

<script type="text/javascript">
	SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.all()
</script>

</body>
</html>
